<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>AngularJS | HaHack</title>
  <meta name="author" content="Joseph Pan">
  
  <meta name="description" content="快速开始
Hello World!
123456789&amp;lt;!doctype html&amp;gt;&amp;lt;html ng-app&amp;gt;    &amp;lt;head&amp;gt;        &amp;lt;script src=&quot;http://code.angularjs.org/angular-1.0.1.min">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="AngularJS"/>
  <meta property="og:site_name" content="HaHack"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/images/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="HaHack" type="application/atom+xml">
  
  <link rel="stylesheet" href="/dist/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/dist/bootstrap-responsive.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/dist/font-awesome.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/dist/style.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/dist/highlight.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/dist/sidenav.min.css" media="screen" type="text/css">  
  <link rel="stylesheet" href="/dist/responsive.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/dist/bubble.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/dist/google-fonts.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/dist/nprogress.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/dist/comment.min.css" media="screen" type="text/css">
  
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<!--  -->
<!--     <link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow|PT+Sans:400,400italic,700,700italic|Droid+Serif:400,400italic' rel='stylesheet' type='text/css'> -->
<!--     <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'> -->
<!--  -->
  
<script src="/dist/jquery-2.0.3.min.js"></script>


    <script src="/dist/videoGFW.min.js"></script>
	
	


    <script src="/dist/comment.js"></script>
    <script src="/dist/markdown.min.js"></script>
    <script src="/dist/timeago.min.js"></script>
	<script src="/dist/spin.min.js"></script>


</head>


<body data-spy="scroll" data-target=".toc">  
  <header id="header" class="inner"><div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
            <a data-pjax class="brand" href="/">HaHack</a>
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <div class="nav-collapse collapse">
            <ul class="nav">				
			    
				   <li><a data-pjax href="/archive" title="所有文章归档"><i class="fa fa-archive"></i>Archive</a></li>				   			    			
				   <li><a data-pjax href="/categories" title="所有文章分类"><i class="fa fa-folder"></i>Categories</a></li>				   			    			
				   <li><a data-pjax href="/tags" title="所有文章标签"><i class="fa fa-tags"></i>Tags</a></li>				   			    			
				
				<li class="divider-vertical"></li>
			   	<li><a data-pjax href="/wiki" title="我的笔记库"><i class="fa fa-tasks"></i>wiki</a></li>				   
				
            </ul>			
			<ul class="nav navright">
				<li class="dropdown">
				<a data-pjax href="#" title="订阅本站" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-rss"></i>Subscribe <b class="caret"></b></a>
                                <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
				
				   <li role="presentation"><a role="menuitem" tabindex="-1" href="/atom.xml" title="使用 RSS 阅读器订阅 HaHack"><i class="fa fa-rss-square"></i>RSS</a></li>
				
				   <li role="presentation"><a role="menuitem" tabindex="-1" href="/wechat.html" title="订阅 HaHack 的公众平台"><i class="fa fa-qrcode"></i>WeChat</a></li>
				
				   <li role="presentation"><a role="menuitem" tabindex="-1" href="http://toutiao.io/u/147640" title=""><i class="fa fa-align-justify"></i>Toutiao</a></li>
				
                	        </ul>
				</li>
				
				<li><a data-pjax href="/about" title="关于我"><i class="fa fa-user"></i>About</a></li>				   				
   					  
            </ul>
            </div> <!-- nav-collapse collapse -->
        </div> <!-- container -->
     </div> <!-- navbar-inner -->
</div> <!-- navbar navbar-inverse -->
</header>
  <div class="container" id="container">
  	<div class="content">
    	 

	
		<div class="page-header">		
			<h1> AngularJS</h1>
		</div>    
	



<div class="row-fluid wiki">
	<!-- span -->
    
        <div class="span3 toc"></div>
        <div class="span9 note">
    

	

		<!-- content -->
		<h2 id="快速开始">快速开始</h2>
<h3 id="hello-world">Hello World!</h3>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="doctype">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">ng-app</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"http://code.angularjs.org/angular-1.0.1.min.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="title">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">body</span>&gt;</span></div><div class="line">        Hello World!</div><div class="line">    <span class="tag">&lt;/<span class="title">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<ul>
<li>标记 <code>ng-app</code> 告诉AngularJS处理整个HTML页并引导应用</li>
<li>使用双大括号标记 <code>{{}}</code> 的内容是问候语中绑定的表达式，这个表达式是一个简单的字符串 ‘World’ 。</li>
</ul>
<h3 id="hello-angularjs-world">Hello AngularJS World!</h3>
<p>本示例演示AngularJS的双向数据绑定（bi-directional data binding）：</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="doctype">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">ng-app</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"http://code.angularjs.org/angular-1.0.1.min.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="title">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">body</span>&gt;</span></div><div class="line">        Your name: <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">ng-model</span>=<span class="value">"yourname"</span> <span class="attribute">placeholder</span>=<span class="value">"World"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="title">hr</span>&gt;</span></div><div class="line">        Hello {{yourname || 'World'}}!</div><div class="line">    <span class="tag">&lt;/<span class="title">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<ul>
<li>文本输入指令<code>&lt;input ng-model=&quot;yourname&quot; /&gt;</code>绑定到一个叫yourname的模型变量。</li>
<li>双大括号标记将yourname模型变量添加到问候语文本。</li>
<li>你不需要为该应用另外注册一个事件侦听器或添加事件处理程序！</li>
</ul>
<h2 id="引导应用">引导应用</h2>
<h3 id="自动初始化">自动初始化</h3>
<p>AngularJS会在DOMContentLoaded事件触发时执行，并通过<code>ng-app</code>指令寻找你的应用根作用域。如果ng-app指令找到了，那么AngularJS将会：</p>
<ul>
<li>载入和指令内容相关的模块。</li>
<li>创建一个应用的“注入器(injector)”。</li>
<li>已拥有<code>ng-app</code>指令的标签为根节点来编译其中的DOM。这使得你可以只指定DOM中的一部分作为你的AngularJS应用。</li>
</ul>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="doctype">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">ng-app</span>=<span class="value">"optionalModuleName"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">body</span>&gt;</span></div><div class="line">        I can add: {{ 1+2 }}.</div><div class="line">        <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"angular.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="title">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="手动初始化">手动初始化</h3>
<p>如果你需要主动控制一下初始化的过程，你可以使用手动执行引导程序的方法。比如当你使用“脚本加载器(script loader)”，或者需要在AngularJS编译页面之前做一些操作，你就会用到它了。</p>
<p>下面的例子演示了手动初始化AngularJS的方法。它的效果等同于使用ng-app指令 。</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="doctype">&lt;!doctype html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">xmlns:ng</span>=<span class="value">"http://angularjs.org"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">body</span>&gt;</span></div><div class="line">        Hello {{'World'}}!</div><div class="line">        <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"http://code.angularjs.org/angular.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span></div><div class="line">            angular.element(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">            angular.bootstrap(<span class="built_in">document</span>);</div><div class="line">            });</div><div class="line">        <span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="title">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>下面是一些你的代码必须遵守的顺序：</p>
<ol>
<li>等页面和所有的脚本加载完之后，找到HTML模板的根节点——通常就是文档的根节点。</li>
<li>调用 <code>api/angular.bootstrap</code> 将模板编译成可执行的、数据双向绑定的应用程序。</li>
</ol>
<h3 id="初始化流程">初始化流程</h3>
<p>AngularJS应用引导过程有3个重要点：</p>
<ul>
<li><a href="http://docs.angularjs.org/api/AUTO.%24injector" target="_blank" rel="external">注入器(injector)</a>将用于创建此应用程序的依赖注入(dependency injection)；</li>
<li>注入器将会创建根作用域作为我们应用模型的范围；</li>
<li>AngularJS将会链接根作用域中的DOM，从用ngApp标记的HTML标签开始，逐步处理DOM中指令和绑定。</li>
</ul>
<p>一旦AngularJS应用引导完毕，它将继续侦听浏览器的HTML触发事件，如鼠标点击事件、按键事件、HTTP传入响应等改变DOM模型的事件。这类事件一旦发生，AngularJS将会自动检测变化，并作出相应的处理及更新。</p>
<p><img src="/images/javascript-angularjs/tutorial_00.png" alt=""></p>
<h2 id="angularjs-模板">AngularJS 模板</h2>
<p>在AngularJS中，一个视图是模型通过 <strong>模板</strong> 渲染之后的映射。这意味着，不论模型什么时候发生变化，AngularJS会实时更新结合点，随之更新视图。</p>
<p>比如，视图组件被AngularJS用下面这个模板构建出来：</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">ng-app</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></div><div class="line">  ...</div><div class="line">  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"lib/angular/angular.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/controllers.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">body</span> <span class="attribute">ng-controller</span>=<span class="value">"PhoneListCtrl"</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="title">ul</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">li</span> <span class="attribute">ng-repeat</span>=<span class="value">"phone in phones"</span>&gt;</span></div><div class="line">      {{phone.name}}</div><div class="line">    <span class="tag">&lt;<span class="title">p</span>&gt;</span>{{phone.snippet}}<span class="tag">&lt;/<span class="title">p</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="title">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="title">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<ul>
<li>在<code>&lt;li&gt;</code>标签里面的 <code>ng-repeat=&quot;phone in phones&quot;</code> 语句是一个AngularJS迭代器。这个迭代器告诉AngularJS用第一个<code>&lt;li&gt;</code>标签作为模板为列表中的每一部手机创建一个<code>&lt;li&gt;</code>元素。</li>
<li>包裹在<code>phone.name</code>和<code>phone.snippet</code>周围的花括号标识着数据绑定。和常量计算不同的是，这里的表达式实际上是我们应用的一个数据模型引用，这些我们在<code>PhoneListCtrl</code>控制器里面都设置好了。</li>
</ul>
<p><img src="/images/javascript-angularjs/tutorial_02.png" alt=""></p>
<p>控制器里面初始化了数据模型，如示例的<code>PhoneListCtrl</code>控制器：</p>
<p><figure class="highlight js"><figcaption><span>app/js/controller.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PhoneListCtrl</span><span class="params">($scope)</span> </span>{</div><div class="line">  $scope.phones = [</div><div class="line">    {<span class="string">"name"</span>: <span class="string">"Nexus S"</span>,</div><div class="line">     <span class="string">"snippet"</span>: <span class="string">"Fast just got faster with Nexus S."</span>},</div><div class="line">    {<span class="string">"name"</span>: <span class="string">"Motorola XOOM™ with Wi-Fi"</span>,</div><div class="line">     <span class="string">"snippet"</span>: <span class="string">"The Next, Next Generation tablet."</span>},</div><div class="line">    {<span class="string">"name"</span>: <span class="string">"MOTOROLA XOOM™"</span>,</div><div class="line">     <span class="string">"snippet"</span>: <span class="string">"The Next, Next Generation tablet."</span>}</div><div class="line">  ];</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>尽管控制器看起来并没有起到什么控制的作用，但是它在这里起到了至关重要的作用。通过给定我们数据模型的语境，控制器允许我们建立模型和视图之间的数据绑定。我们是这样把表现层，数据和逻辑部件联系在一起的：</p>
<ul>
<li><code>PhoneListCtrl</code>——控制器方法的名字（在JS文件controllers.js中）和<code>&lt;body&gt;</code>标签里面的ngController指令的值相匹配。</li>
<li>手机的数据此时与注入到我们控制器函数的 <strong>作用域（<code>$scope</code>）</strong> 相关联。当应用启动之后，会有一个根作用域被创建出来，而控制器的作用域是根作用域的一个典型后继。这个控制器的作用域对所有<code>&lt;body ng-controller=&quot;PhoneListCtrl&quot;&gt;</code>标记内部的数据绑定有效。</li>
</ul>
<p>AngularJS的作用域理论非常重要：一个作用域可以视作模板、模型和控制器协同工作的粘接器。AngularJS使用作用域，同时还有模板中的信息，数据模型和控制器。这些可以帮助模型和视图分离，但是他们两者确实是同步的！任何对于模型的更改都会即时反映在视图上；任何在视图上的更改都会被立刻体现在模型中。</p>
<h2 id="迭代器过滤">迭代器过滤</h2>
<p>本节利用过滤器实现一个全文检索。</p>
<h3 id="模板">模板</h3>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"container-fluid"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"row-fluid"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"span2"</span>&gt;</span></div><div class="line">      <span class="comment">&lt;!--Sidebar content--&gt;</span></div><div class="line"></div><div class="line">      Search: <span class="tag">&lt;<span class="title">input</span> <span class="attribute">ng-model</span>=<span class="value">"query"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"span10"</span>&gt;</span></div><div class="line">      <span class="comment">&lt;!--Body content--&gt;</span></div><div class="line"></div><div class="line">      <span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"phones"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="title">li</span> <span class="attribute">ng-repeat</span>=<span class="value">"phone in phones | filter:query"</span>&gt;</span></div><div class="line">          {{phone.name}}</div><div class="line">        <span class="tag">&lt;<span class="title">p</span>&gt;</span>{{phone.snippet}}<span class="tag">&lt;/<span class="title">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="title">li</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="title">ul</span>&gt;</span></div><div class="line"></div><div class="line">       <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<ul>
<li>数据绑定： 这是AngularJS的一个核心特性。当页面加载的时候，AngularJS会根据输入框的属性值名字，将其与数据模型中相同名字的变量绑定在一起，以确保两者的同步性。</li>
</ul>
<p>在这段代码中，用户在输入框中输入的数据名字称作<code>query</code>，会立刻作为列表迭代器 <code>(phone in phones | filter:query)</code> 其过滤器的输入。当数据模型引起迭代器输入变化的时候，迭代器可以高效得更新DOM将数据模型最新的状态反映出来。</p>
<ul>
<li>使用<code>filter</code>过滤器：<code>filter</code>函数使用<code>query</code>的值来创建一个只包含匹配<code>query</code>记录的新数组。</li>
</ul>
<p>ngRepeat会根据<code>filter</code>过滤器生成的手机记录数据数组来自动更新视图。整个过程对于开发者来说都是透明的。</p>
<h2 id="双向绑定">双向绑定</h2>
<p>本节演示利用双向绑定实现动态排序：添加一个新的模型属性，把它和迭代器集成起来，然后让数据绑定完成剩下的事情。</p>
<h3 id="模板-v2">模板</h3>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Search: <span class="tag">&lt;<span class="title">input</span> <span class="attribute">ng-model</span>=<span class="value">"query"</span>&gt;</span></div><div class="line">Sort by:</div><div class="line"><span class="tag">&lt;<span class="title">select</span> <span class="attribute">ng-model</span>=<span class="value">"orderProp"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="title">option</span> <span class="attribute">value</span>=<span class="value">"name"</span>&gt;</span>Alphabetical<span class="tag">&lt;/<span class="title">option</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="title">option</span> <span class="attribute">value</span>=<span class="value">"age"</span>&gt;</span>Newest<span class="tag">&lt;/<span class="title">option</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">select</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"phones"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">ng-repeat</span>=<span class="value">"phone in phones | filter:query | orderBy:orderProp"</span>&gt;</span></div><div class="line">    {{phone.name}}</div><div class="line">    <span class="tag">&lt;<span class="title">p</span>&gt;</span>{{phone.snippet}}<span class="tag">&lt;/<span class="title">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="title">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">ul</span>&gt;</span></div></pre></td></tr></table></figure></p>
<ul>
<li>首先，我们增加了一个叫做<code>orderProp</code>的<code>&lt;select&gt;</code>标签，这样我们的用户就可以选择我们提供的两种排序方法。</li>
<li>然后，在<code>filter</code>过滤器后面添加一个<code>orderBy</code>过滤器用其来处理进入迭代器的数据。<code>orderBy</code>过滤器以一个数组作为输入，复制一份副本，然后把副本重排序再输出到迭代器。</li>
</ul>
<p>AngularJS在<code>select</code>元素和<code>orderProp</code>模型之间创建了一个双向绑定。而后，<code>orderProp</code>会被用作<code>orderBy</code>过滤器的输入。</p>
<h3 id="控制器">控制器</h3>
<p><figure class="highlight js"><figcaption><span>app/js/controllers.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PhoneListCtrl</span><span class="params">($scope)</span> </span>{</div><div class="line">  $scope.phones = [</div><div class="line">    {<span class="string">"name"</span>: <span class="string">"Nexus S"</span>,</div><div class="line">     <span class="string">"snippet"</span>: <span class="string">"Fast just got faster with Nexus S."</span>,</div><div class="line">     <span class="string">"age"</span>: <span class="number">0</span>},</div><div class="line">    {<span class="string">"name"</span>: <span class="string">"Motorola XOOM™ with Wi-Fi"</span>,</div><div class="line">     <span class="string">"snippet"</span>: <span class="string">"The Next, Next Generation tablet."</span>,</div><div class="line">     <span class="string">"age"</span>: <span class="number">1</span>},</div><div class="line">    {<span class="string">"name"</span>: <span class="string">"MOTOROLA XOOM™"</span>,</div><div class="line">     <span class="string">"snippet"</span>: <span class="string">"The Next, Next Generation tablet."</span>,</div><div class="line">     <span class="string">"age"</span>: <span class="number">2</span>}</div><div class="line">  ];</div><div class="line"></div><div class="line">  $scope.orderProp = <span class="string">'age'</span>;</div><div class="line">}</div></pre></td></tr></table></figure></p>
<ul>
<li>为每一个手机记录其增加了一个<code>age</code>属性，以便根据<code>age</code>属性对手机进行排序。</li>
<li>在控制器代码里加了一行让<code>orderProp</code>的默认值为<code>age</code>。如果我们不设置默认值，这个模型会在我们的用户在下拉菜单选择一个顺序之前一直处于未初始化状态。</li>
</ul>
<h2 id="xhr和依赖注入">XHR和依赖注入</h2>
<p>本节演示使用AngularJS一个内置服务<code>$http</code>来获取网络数据集。我们将使用AngularJS的依赖注入（dependency injection (DI)）功能来为PhoneListCtrl控制器提供这个AngularJS服务。</p>
<h3 id="控制器-v2">控制器</h3>
<p>在控制器中使用AngularJS服务<a href="http://code.angularjs.org/1.1.0/docs/api/ng.%24http" target="_blank" rel="external"><code>$http</code></a>向Web服务器发起一个HTTP请求，以此从<code>app/phones/phones.json</code>文件中获取数据。<code>$http</code>仅仅是AngularJS众多内建服务中之一，这些服务可以处理一些Web应用的通用操作。AngularJS能将这些服务注入到任何你需要它们的地方。</p>
<p>服务是通过AngularJS的<a href="http://angularjs.cn/A00z" target="_blank" rel="external">依赖注入DI子系统</a>来管理的。依赖注入服务可以使你的Web应用良好构建（比如分离表现层、数据和控制三者的部件）并且松耦合（一个部件自己不需要解决部件之间的依赖问题，它们都被DI子系统所处理）。</p>
<p><figure class="highlight js"><figcaption><span>app/js/controllers.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PhoneListCtrl</span><span class="params">($scope, $http)</span> </span>{</div><div class="line">  $http.get(<span class="string">'phones/phones.json'</span>).success(<span class="function"><span class="keyword">function</span><span class="params">(data)</span> </span>{</div><div class="line">    $scope.phones = data;</div><div class="line">  });</div><div class="line"></div><div class="line">  $scope.orderProp = <span class="string">'age'</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//PhoneListCtrl.$inject = ['$scope', '$http'];</span></div></pre></td></tr></table></figure></p>
<p><code>$http</code>向Web服务器发起一个HTTP GET请求，索取phone/phones.json（注意，url是相对于我们的index.html文件的）。服务器用json文件中的数据作为响应。（这个响应或许是实时从后端服务器动态产生的。但是对于浏览器来说，它们看起来都是一样的。为了简单起见，我们在教程里面简单地使用了一个json文件。）</p>
<p><code>$http</code>服务用success返回对象应答。当异步响应到达时，用这个对象应答函数来处理服务器响应的数据，并且把数据赋值给作用域的phones数据模型。注意到AngularJS会自动检测到这个json应答，并且已经为我们解析出来了！</p>
<p>为了使用AngularJS的服务，你只需要在控制器的构造函数里面作为参数声明出所需服务的名字，就像这样：</p>
<p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PhoneListCtrl</span><span class="params">($scope, $http)</span> </span>{...}</div></pre></td></tr></table></figure></p>
<p>当控制器构造的时候，AngularJS的依赖注入器会将这些服务注入到你的控制器中。当然，依赖注入器也会处理所需服务可能存在的任何传递性依赖（一个服务通常会依赖于其他的服务）。</p>
<p>注意到参数名字非常重要，因为注入器会用他们去寻找相应的依赖。</p>
<p>{% alert yellow %}
<code>$</code> 前缀命名习惯</p>
<p>作为一个命名习惯，AngularJS内建服务，作用域方法，以及一些其他的AngularJS API都在名字前面使用一个<code>$</code>前缀。不要使用<code>$</code>前缀来命名你自己的服务和模型，否则可能会产生名字冲突。
{% endalert %}</p>
<p>{% alert green %}
关于JS压缩</p>
<p>由于AngularJS是通过控制器构造函数的参数名字来推断依赖服务名称的。所以如果你要压缩PhoneListCtrl控制器的JS代码，它所有的参数也同时会被压缩，这时候依赖注入系统就不能正确的识别出服务了。</p>
<p>为了克服压缩引起的问题，只要在控制器函数里面给<code>$inject</code>属性赋值一个依赖服务标识符的数组，就像被注释掉那段最后一行那样：</p>
<p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PhoneListCtrl.$inject = [<span class="string">'$scope'</span>, <span class="string">'$http'</span>];</div></pre></td></tr></table></figure></p>
<p>另一种方法也可以用来指定依赖列表并且避免压缩问题——使用Javascript数组方式构造控制器：把要注入的服务放到一个字符串数组（代表依赖的名字）里，数组最后一个元素是控制器的方法函数：</p>
<p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> PhoneListCtrl = [<span class="string">'$scope'</span>, <span class="string">'$http'</span>, <span class="function"><span class="keyword">function</span><span class="params">($scope, $http)</span> </span>{ <span class="comment">/* constructor body */</span> }];</div></pre></td></tr></table></figure></p>
<p>上面提到的两种方法都能和AngularJS可注入的任何函数完美协作，要选哪一种方式完全取决于你们项目的编程风格，建议使用数组方式。
{% endalert %}</p>
<h2 id="链接与图片模板">链接与图片模板</h2>
<p>本节演示如何编写模板添加图片缩略图和链接。</p>
<h3 id="模板-v3">模板</h3>
<p><figure class="highlight html"><figcaption><span>app/index.html</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">        <span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"phones"</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="title">li</span> <span class="attribute">ng-repeat</span>=<span class="value">"phone in phones | filter:query | orderBy:orderProp"</span> <span class="attribute">class</span>=<span class="value">"thumbnail"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#/phones/{{phone.id}}"</span> <span class="attribute">class</span>=<span class="value">"thumb"</span>&gt;</span><span class="tag">&lt;<span class="title">img</span> <span class="attribute">ng-src</span>=<span class="value">"{{phone.imageUrl}}"</span>&gt;</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#/phones/{{phone.id}}"</span>&gt;</span>{{phone.name}}<span class="tag">&lt;/<span class="title">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="title">p</span>&gt;</span>{{phone.snippet}}<span class="tag">&lt;/<span class="title">p</span>&gt;</span></div><div class="line">          <span class="tag">&lt;/<span class="title">li</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="title">ul</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>处理图片比较简单，只需要使用<code>ngSrc</code>指令代替<code>&lt;img&gt;</code>的<code>src</code>属性标签就可以了。使用<code>ngSrc</code>指令防止浏览器产生一个指向非法地址的请求。</p>
<h2 id="路由与多视图">路由与多视图</h2>
<p>在本节之前，应用只给我们的用户提供了一个简单的界面（一张所有手机的列表），并且所有的模板代码位于index.html文件中。下一步是增加一个能够显示我们列表中每一部手机详细信息的页面。</p>
<p>为了增加详细信息视图，我们可以拓展index.html来同时包含两个视图的模板代码，但是这样会很快给我们带来巨大的麻烦。相反，我们要把index.html模板转变成“布局模板”。这是我们应用所有视图的通用模板。其他的“局部布局模板”随后根据当前的“路由”被充填入，从而形成一个完整视图展示给用户。</p>
<p>AngularJS中应用的路由通过<code>$routeProvider</code>来声明，它是<code>$route</code>服务的提供者。这项服务使得控制器、视图模板与当前浏览器的URL可以轻易集成。应用这个特性我们就可以实现深链接，它允许我们使用浏览器的历史(回退或者前进导航)和书签。</p>
<h3 id="关于依赖注入-di-注入器-injector-和服务提供者-providers">关于依赖注入（DI），注入器（Injector）和服务提供者（Providers）</h3>
<p>正如从前面你学到的，依赖注入是AngularJS的核心特性，所以你必须要知道一点这家伙是怎么工作的。</p>
<p>当应用引导时，AngularJS会创建一个注入器，我们应用后面所有依赖注入的服务都会需要它。这个注入器自己并不知道<code>$http</code>和<code>$route</code>是干什么的，实际上除非它在模块定义的时候被配置过，否则它根本都不知道这些服务的存在。注入器唯一的职责是载入指定的服务模块，在这些模块中注册所有定义的服务提供者，并且当需要时给一个指定的函数注入依赖（服务）。这些依赖通过它们的提供者“懒惰式”（需要时才加载）实例化。</p>
<p>提供者是提供（创建）服务实例并且对外提供API接口的对象，它可以被用来控制一个服务的创建和运行时行为。对于<code>$route</code>服务来说，<code>$routeProvider</code>对外提供了API接口，通过API接口允许你为你的应用定义路由规则。</p>
<p>AngularJS模块解决了从应用中删除全局状态和提供方法来配置注入器这两个问题。和AMD或者require.js这两个模块（非AngularJS的两个库）不同的是，AngularJS模块并没有试图去解决脚本加载顺序以及懒惰式脚本加载这样的问题。这些目标和AngularJS要解决的问题毫无关联，所以这些模块完全可以共存来实现各自的目标。</p>
<h3 id="app-模块">App 模块</h3>
<p><figure class="highlight js"><figcaption><span>app/js/app.js </span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">'phonecat'</span>, []).</div><div class="line">  config([<span class="string">'$routeProvider'</span>, <span class="function"><span class="keyword">function</span><span class="params">($routeProvider)</span> </span>{</div><div class="line">  $routeProvider.</div><div class="line">      when(<span class="string">'/phones'</span>, {templateUrl: <span class="string">'partials/phone-list.html'</span>,   controller: PhoneListCtrl}).</div><div class="line">      when(<span class="string">'/phones/:phoneId'</span>, {templateUrl: <span class="string">'partials/phone-detail.html'</span>, controller: PhoneDetailCtrl}).</div><div class="line">      otherwise({redirectTo: <span class="string">'/phones'</span>});</div><div class="line">}]);</div></pre></td></tr></table></figure></p>
<p>为了给我们的应用配置路由，我们需要给应用创建一个模块。我们管这个模块叫做phonecat，并且通过使用configAPI，我们请求把<code>$routeProvider</code>注入到我们的配置函数并且使用<code>$routeProvider.whenAPI</code>来定义我们的路由规则。</p>
<p>我们的路由规则定义如下：</p>
<ul>
<li>当 URL 映射段为<code>/phones</code>时，手机列表视图会被显示出来。为了构造这个视图，AngularJS会使用phone-list.html模板和PhoneListCtrl控制器。</li>
<li>当 URL 映射段为<code>/phone/:phoneId</code>时，手机详细信息视图被显示出来。这里<code>:phoneId</code>是URL的变量部分。为了构造手机详细视图，AngularJS会使用phone-detail.html模板和PhoneDetailCtrl控制器。</li>
</ul>
<p>我们重用之前创造过的PhoneListCtrl控制器，同时我们为手机详细视图添加一个新的PhoneDetailCtrl控制器，把它存放在app/js/controllers.js文件里。</p>
<p><code>$route.otherwise({redirectTo: '/phones'})</code>语句使得当浏览器地址不能匹配我们任何一个路由规则时，触发重定向到/phones。</p>
<p>注意到在第二条路由声明中<code>:phoneId</code>参数的使用。<code>$route</code>服务使用路由声明<code>/phones/:phoneId</code>作为一个匹配当前URL的模板。所有以<code>:</code>符号声明的变量（此处变量为phones）都会被提取，然后存放在<code>$routeParams</code>对象中。</p>
<p>为了让我们的应用引导我们新创建的模块，我们同时需要在<code>ngApp</code>指令的值上指明模块的名字：</p>
<p><figure class="highlight js"><figcaption><span>app/index.html</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;!doctype html&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en"</span> <span class="attribute">ng-app</span>=<span class="value">"phonecat"</span>&gt;</span></span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<h3 id="控制器-v3">控制器</h3>
<p><figure class="highlight js"><figcaption><span>app/js/controllers.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PhoneDetailCtrl</span><span class="params">($scope, $routeParams)</span> </span>{</div><div class="line">  $scope.phoneId = $routeParams.phoneId;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//PhoneDetailCtrl.$inject = ['$scope', '$routeParams'];</span></div></pre></td></tr></table></figure></p>
<h3 id="模板-v4">模板</h3>
<p><code>$route</code>服务通常和<code>ngView</code>指令一起使用。<code>ngView</code>指令的角色是为当前路由把对应的视图模板载入到布局模板中。</p>
<p><figure class="highlight js"><figcaption><span>app/index.html </span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;html lang=<span class="string">"en"</span> ng-app=<span class="string">"phonecat"</span>&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span></div><div class="line">...</div><div class="line">  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"lib/angular/angular.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/app.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/controllers.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-view</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>注意，我们把index.html模板里面大部分代码移除，我们只放置了一个<code>&lt;div&gt;</code>容器，这个<code>&lt;div&gt;</code>具有<code>ng-view</code>属性。我们删除掉的代码现在被放置在phone-list.html模板中：</p>
<p><figure class="highlight html"><figcaption><span>app/partials/phone-list.html</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"container-fluid"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"row-fluid"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"span2"</span>&gt;</span></div><div class="line">      <span class="comment">&lt;!--Sidebar content--&gt;</span></div><div class="line"></div><div class="line">      Search: <span class="tag">&lt;<span class="title">input</span> <span class="attribute">ng-model</span>=<span class="value">"query"</span>&gt;</span></div><div class="line">      Sort by:</div><div class="line">      <span class="tag">&lt;<span class="title">select</span> <span class="attribute">ng-model</span>=<span class="value">"orderProp"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="title">option</span> <span class="attribute">value</span>=<span class="value">"name"</span>&gt;</span>Alphabetical<span class="tag">&lt;/<span class="title">option</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="title">option</span> <span class="attribute">value</span>=<span class="value">"age"</span>&gt;</span>Newest<span class="tag">&lt;/<span class="title">option</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="title">select</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"span10"</span>&gt;</span></div><div class="line">      <span class="comment">&lt;!--Body content--&gt;</span></div><div class="line"></div><div class="line">      <span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"phones"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="title">li</span> <span class="attribute">ng-repeat</span>=<span class="value">"phone in phones | filter:query | orderBy:orderProp"</span> <span class="attribute">class</span>=<span class="value">"thumbnail"</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#/phones/{{phone.id}}"</span> <span class="attribute">class</span>=<span class="value">"thumb"</span>&gt;</span><span class="tag">&lt;<span class="title">img</span> <span class="attribute">ng-src</span>=<span class="value">"{{phone.imageUrl}}"</span>&gt;</span><span class="tag">&lt;/<span class="title">a</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"#/phones/{{phone.id}}"</span>&gt;</span>{{phone.name}}<span class="tag">&lt;/<span class="title">a</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="title">p</span>&gt;</span>{{phone.snippet}}<span class="tag">&lt;/<span class="title">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="title">li</span>&gt;</span></div><div class="line">      <span class="tag">&lt;/<span class="title">ul</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="title">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>同时我们为手机详细信息视图添加一个占位模板。</p>
<p><figure class="highlight html"><figcaption><span>app/partials/phone-detail.html </span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TBD: detail view for {{phoneId}}</div></pre></td></tr></table></figure></p>
<p>注意到我们的布局模板中没再添加<code>PhoneListCtrl</code>或<code>PhoneDetailCtrl</code>控制器属性！</p>
<h2 id="过滤器">过滤器</h2>
<p>本节演示使用一个定制的过滤器来把文本串图形化：√作为“true”；以及×作为“false”。来让我们看看过滤器代码长什么样子。</p>
<h3 id="定制过滤器">定制过滤器</h3>
<p>为了创建一个新的过滤器，先创建一个phonecatFilters模块，并且将定制的过滤器注册给这个模块。</p>
<p><figure class="highlight js"><figcaption><span>app/js/filters.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">'phonecatFilters'</span>, []).filter(<span class="string">'checkmark'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">(input)</span> </span>{</div><div class="line">    <span class="keyword">return</span> input ? <span class="string">'\u2713'</span> : <span class="string">'\u2718'</span>;</div><div class="line">  };</div><div class="line">});</div></pre></td></tr></table></figure></p>
<p>我们的过滤器命名为checkmark。它的输入要么是true，要么是false，并且我们返回两个表示true或false的unicode字符（<code>\u2713</code>和<code>\u2718</code>）。</p>
<p>现在我们的过滤器准备好了，我们需要将我们的phonecatFilters模块作为一个依赖注册到我们的主模块phonecat上。</p>
<p><figure class="highlight js"><figcaption><span>app/js/app/js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">angular.module(<span class="string">'phonecat'</span>, [<span class="string">'phonecatFilters'</span>]).</div><div class="line">...</div></pre></td></tr></table></figure></p>
<h3 id="模板-v5">模板</h3>
<p>由于我们的模板代码写在app/js/filter.js文件中，所以我们需要在布局模板中引入这个文件。</p>
<p><figure class="highlight html"><figcaption><span>app/index.html</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"> <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/controllers.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/filters.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>在AngularJS模板中使用过滤器的语法是：</p>
<p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">{{ expression | filter }}</div></pre></td></tr></table></figure></p>
<p>我们把过滤器应用到手机详细信息模板中：</p>
<p><figure class="highlight html"><figcaption><span>app/partials/phone-detail.html</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">    <span class="tag">&lt;<span class="title">dl</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">dt</span>&gt;</span>Infrared<span class="tag">&lt;/<span class="title">dt</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">dd</span>&gt;</span>{{phone.connectivity.infrared | checkmark}}<span class="tag">&lt;/<span class="title">dd</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">dt</span>&gt;</span>GPS<span class="tag">&lt;/<span class="title">dt</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">dd</span>&gt;</span>{{phone.connectivity.gps | checkmark}}<span class="tag">&lt;/<span class="title">dd</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="title">dl</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<h2 id="事件处理器">事件处理器</h2>
<p>本节演示如何通过事件处理器实现点击手机缩略图可以将细节图修改成该缩略图的大图。</p>
<p><figure class="highlight js"><figcaption><span>app/js/controllers.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PhoneDetailCtrl</span><span class="params">($scope, $routeParams, $http)</span> </span>{</div><div class="line">  $http.get(<span class="string">'phones/'</span> + $routeParams.phoneId + <span class="string">'.json'</span>).success(<span class="function"><span class="keyword">function</span><span class="params">(data)</span> </span>{</div><div class="line">    $scope.phone = data;</div><div class="line">    $scope.mainImageUrl = data.images[<span class="number">0</span>];</div><div class="line">  });</div><div class="line"></div><div class="line"> $scope.setImage = <span class="function"><span class="keyword">function</span><span class="params">(imageUrl)</span> </span>{</div><div class="line">    $scope.mainImageUrl = imageUrl;</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//PhoneDetailCtrl.$inject = ['$scope', '$routeParams', '$http'];</span></div></pre></td></tr></table></figure></p>
<p>在PhoneDetailCtrl控制器中，我们创建了mainImageUrl模型属性，并且把它的默认值设为第一个手机图片的URL。</p>
<h3 id="模板-v6">模板</h3>
<p><figure class="highlight html"><figcaption><span>app/partials/phone-detail.html</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">img</span> <span class="attribute">ng-src</span>=<span class="value">"{{mainImageUrl}}"</span> <span class="attribute">class</span>=<span class="value">"phone"</span>&gt;</span></div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"phone-thumbs"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">ng-repeat</span>=<span class="value">"img in phone.images"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">img</span> <span class="attribute">ng-src</span>=<span class="value">"{{img}}"</span> <span class="attribute">ng-click</span>=<span class="value">"setImage(img)"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="title">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">ul</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>我们把大图片的<code>ngSrc</code>指令绑定到mainImageUrl属性上。</p>
<p>同时我们注册一个<code>ngClick</code>处理器到缩略图上。当一个用户点击缩略图的任意一个时，这个处理器会使用setImage事件处理函数来把mainImageUrl属性设置成选定缩略图的URL。</p>
<h2 id="rest和定制服务">REST和定制服务</h2>
<p>本节演示定义一个代表RESTful客户端的定制服务。有了这个客户端我们可以用一种更简单的方式来发送XHR请求，而不用去关心更底层的<code>$http</code>服务（API、HTTP方法和URL）。</p>
<h3 id="模板-v7">模板</h3>
<p>定制的服务被定义在app/js/services，所以我们需要在布局模板中引入这个文件。另外，我们也要加载angularjs-resource.js这个文件，它包含了ngResource模块以及其中的<code>$resource</code>服务，我们一会就会用到它们：</p>
<p><figure class="highlight html"><figcaption><span>app/index.html</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/services.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"lib/angular/angular-resource.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<h3 id="服务">服务</h3>
<p><figure class="highlight js"><figcaption><span>app/js/services.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">'phonecatServices'</span>, [<span class="string">'ngResource'</span>]).</div><div class="line">    factory(<span class="string">'Phone'</span>, <span class="function"><span class="keyword">function</span><span class="params">($resource)</span></span>{</div><div class="line">      <span class="keyword">return</span> $resource(<span class="string">'phones/:phoneId.json'</span>, {}, {</div><div class="line">        query: {method:<span class="string">'GET'</span>, params:{phoneId:<span class="string">'phones'</span>}, isArray:<span class="literal">true</span>}</div><div class="line">      });</div><div class="line">    });</div></pre></td></tr></table></figure></p>
<p>我们使用模块API通过一个工厂方法注册了一个定制服务。我们传入服务的名字Phone和工厂函数。工厂函数和控制器构造函数差不多，它们都通过函数参数声明依赖服务。Phone服务声明了它依赖于<code>$resource</code>服务。</p>
<p><code>$resource</code>服务使得用短短的几行代码就可以创建一个RESTful客户端。我们的应用使用这个客户端来代替底层的<code>$http</code>服务。</p>
<p><figure class="highlight js"><figcaption><span>app/js/app.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">angular.module(<span class="string">'phonecat'</span>, [<span class="string">'phonecatFilters'</span>, <span class="string">'phonecatServices'</span>]).</div><div class="line">...</div><div class="line">我们需要把phonecatServices添加到phonecat的依赖数组里。</div></pre></td></tr></table></figure></p>
<h3 id="控制器-v4">控制器</h3>
<p>通过重构掉底层的<code>$http</code>服务，把它放在一个新的服务Phone中，我们可以大大简化子控制器（PhoneListCtrl和PhoneDetailCtrl）。AngularJS的<code>$resource</code>相比于<code>$http</code>更加适合于与RESTful数据源交互。而且现在我们更容易理解控制器这些代码在干什么了。</p>
<p><figure class="highlight js"><figcaption><span>app/js/controllers.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PhoneListCtrl</span><span class="params">($scope, Phone)</span> </span>{</div><div class="line">  $scope.phones = Phone.query();</div><div class="line">  $scope.orderProp = <span class="string">'age'</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//PhoneListCtrl.$inject = ['$scope', 'Phone'];</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PhoneDetailCtrl</span><span class="params">($scope, $routeParams, Phone)</span> </span>{</div><div class="line">  $scope.phone = Phone.get({phoneId: $routeParams.phoneId}, <span class="function"><span class="keyword">function</span><span class="params">(phone)</span> </span>{</div><div class="line">    $scope.mainImageUrl = phone.images[<span class="number">0</span>];</div><div class="line">  });</div><div class="line"></div><div class="line">  $scope.setImage = <span class="function"><span class="keyword">function</span><span class="params">(imageUrl)</span> </span>{</div><div class="line">    $scope.mainImageUrl = imageUrl;</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//PhoneDetailCtrl.$inject = ['$scope', '$routeParams', 'Phone'];</span></div></pre></td></tr></table></figure></p>
<p>注意到，在PhoneListCtrl里我们把：</p>
<p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$http.get(<span class="string">'phones/phones.json'</span>).success(<span class="function"><span class="keyword">function</span><span class="params">(data)</span> </span>{</div><div class="line">  $scope.phones = data;</div><div class="line">});</div></pre></td></tr></table></figure></p>
<p>换成了：</p>
<p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$scope.phones = Phone.query();</div></pre></td></tr></table></figure></p>
<p>我们通过这条简单的语句来查询所有的手机。</p>
<p>另一个非常需要注意的是，在上面的代码里面，当调用Phone服务的方法是我们并没有传递任何回调函数。尽管这看起来结果是同步返回的，其实根本就不是。被同步返回的是一个“future”——一个对象，当XHR相应返回的时候会填充进数据。鉴于AngularJS的数据绑定，我们可以使用future并且把它绑定到我们的模板上。然后，当数据到达时，我们的视图会自动更新。</p>
<p>有的时候，单单依赖future对象和数据绑定不足以满足我们的需求，所以在这些情况下，我们需要添加一个回调函数来处理服务器的响应。PhoneDetailCtrl控制器通过在一个回调函数中设置mainImageUrl就是一个解释。</p>
<h2 id="后续学习">后续学习</h2>
<ul>
<li><a href="https://github.com/angular/angular-seed" target="_blank" rel="external">AngularJS种子项目</a></li>
<li><a href="http://docs.angularjs.org/cookbook/index" target="_blank" rel="external">AngularJS Cookbook</a></li>
<li><a href="http://angularjs.cn/T008" target="_blank" rel="external">AngularJS 开发指南</a></li>
</ul>


		<!-- pagination -->
		<div>
		<center>
		<div class="pagination">
<ul class="pagination">
	
	
	
		
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
			
		
	
	    
			
		
	
	    
	
	    
			
		
	
	    
			
		
	
	    
			
		
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
	
	    
			
			
		
	
	    
	
	
		<li class="prev"><a data-pjax href="/wiki/javascript-tables.html" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
	
	<li><a data-pjax href="/wiki"><i class="fa fa-tasks"></i>Wiki</a></li>
	
		<li class="next disabled"><a>Next<i class="fa fa-arrow-circle-o-right"></i></a></li>
	
</ul>
</div>

	    </center>
		</div>
				
		<!-- toc -->
		
   	<script type="text/javascript">
		jQuery(document).ready(function() {
		
 		   generateWikiTOC('.note', '.toc', 2, 2 );
		
		});
	</script>



				
		<!-- comment -->
		
<section id="comment">
    <h2 class="title">Comments</h2>
	
	 <div id="comment-thread"></div>
	 <div id="loading-spin"></div>
	 <script type="text/javascript">
	   getComments({
		       type: "github",
	           user: "wzpan",
	           repo: "wzpan.github.io",
			   client_id: "1eb35434de75c06a513f",
			   client_secret: "6e4193f8ecd619cdfac2b1aa16b3663fe18d2e90",
			   no_comment: "暂时还没有留言呢，点击下面的按钮去留言吧！",
			   go_to_comment: "去留言",
			   btn_class: "btn btn-primary",
			   no_issue: "no_issue",
			   issue_title: "AngularJS",
			   issue_id: "undefined",
			   comments_target: "#comment-thread" ? "#comment-thread" : "#comment-thread",
			   loading_target: "undefined"
			   });
	 </script>
	
</section>


		

	</div> <!-- span9/span12 -->
</div><!-- row-fluid post-full -->

	</div>	
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2017 Joseph Pan
  
      with help from <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> and 
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1254469760'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1254469760' type='text/javascript'%3E%3C/script%3E"));</script>
. 
    <small>
     <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh"><img title="知识共享许可协议" style="border-width: 0px; vertical-align: middle; display: inline; " src="/images/license.png"></a>
    </small>
</p>
 </footer>
</div> <!-- container-narrow -->


<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/dist/jquery.imagesloaded.min.js"></script>


<script src="/dist/gallery.min.js"></script>
<script src="/dist/bootstrap.min.js"></script>
<script src="/dist/jquery.tableofcontents.min.js"></script>
<script src="/dist/tocgenerator.min.js"></script>
<script src="/dist/require.min.js"></script>
<script src="/dist/main.min.js"></script>


<script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>




<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v1/st.js','_st');

  _st('install','ney3Rb77vMaWT2KUKFyt');
</script>


</body>
</html>
